"use strict";(globalThis.webpackChunkdocuments=globalThis.webpackChunkdocuments||[]).push([[5954],{28453:(e,n,o)=>{o.d(n,{R:()=>l,x:()=>c});var i=o(96540);const r={},s=i.createContext(r);function l(e){const n=i.useContext(s);return i.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function c(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:l(e.components),i.createElement(s.Provider,{value:n},e.children)}},91684:(e,n,o)=>{o.r(n),o.d(n,{assets:()=>t,contentTitle:()=>c,default:()=>g,frontMatter:()=>l,metadata:()=>i,toc:()=>a});const i=JSON.parse('{"id":"project-knowledge/ateliers-ai-mcp/content/logging/USAGE","title":"MCP \u30ed\u30ae\u30f3\u30b0\u4f7f\u7528\u65b9\u6cd5","description":"Ateliers.Ai.Mcp \u306e\u30ed\u30ae\u30f3\u30b0\u306e\u4f7f\u7528\u65b9\u6cd5\u306b\u95a2\u3059\u308b\u30ac\u30a4\u30c9","source":"@site/docs/project-knowledge/ateliers-ai-mcp/content/logging/USAGE.md","sourceDirName":"project-knowledge/ateliers-ai-mcp/content/logging","slug":"/project-knowledge/ateliers-ai-mcp/content/logging/USAGE","permalink":"/docs/project-knowledge/ateliers-ai-mcp/content/logging/USAGE","draft":false,"unlisted":false,"editUrl":"https://github.com/yuu-git/ateliers-dev/edit/master/docs/project-knowledge/ateliers-ai-mcp/content/logging/USAGE.md","tags":[{"inline":true,"label":"Ateliers.Ai.Mcp","permalink":"/docs/tags/ateliers-ai-mcp"},{"inline":true,"label":"Logging","permalink":"/docs/tags/logging"},{"inline":true,"label":"\u30ed\u30ae\u30f3\u30b0","permalink":"/docs/tags/\u30ed\u30ae\u30f3\u30b0"},{"inline":true,"label":"\u4f7f\u3044\u65b9","permalink":"/docs/tags/\u4f7f\u3044\u65b9"}],"version":"current","frontMatter":{"title":"MCP \u30ed\u30ae\u30f3\u30b0\u4f7f\u7528\u65b9\u6cd5","sidebar_label":"MCP \u30ed\u30ae\u30f3\u30b0\u4f7f\u7528\u65b9\u6cd5","tags":["Ateliers.Ai.Mcp","Logging","\u30ed\u30ae\u30f3\u30b0","\u4f7f\u3044\u65b9"],"description":"Ateliers.Ai.Mcp \u306e\u30ed\u30ae\u30f3\u30b0\u306e\u4f7f\u7528\u65b9\u6cd5\u306b\u95a2\u3059\u308b\u30ac\u30a4\u30c9"},"sidebar":"projectKnowledgeSidebar","previous":{"title":"\u30ed\u30ae\u30f3\u30b0\u5b9f\u8df5\u30ac\u30a4\u30c9","permalink":"/docs/project-knowledge/ateliers-ai-mcp/content/logging/Logging-PracticalGuide"},"next":{"title":"MCP \u5b9f\u884c\u30b3\u30f3\u30c6\u30ad\u30b9\u30c8\u4f7f\u7528\u65b9\u6cd5","permalink":"/docs/project-knowledge/ateliers-ai-mcp/content/McpContext/USAGE"}}');var r=o(74848),s=o(28453);const l={title:"MCP \u30ed\u30ae\u30f3\u30b0\u4f7f\u7528\u65b9\u6cd5",sidebar_label:"MCP \u30ed\u30ae\u30f3\u30b0\u4f7f\u7528\u65b9\u6cd5",tags:["Ateliers.Ai.Mcp","Logging","\u30ed\u30ae\u30f3\u30b0","\u4f7f\u3044\u65b9"],description:"Ateliers.Ai.Mcp \u306e\u30ed\u30ae\u30f3\u30b0\u306e\u4f7f\u7528\u65b9\u6cd5\u306b\u95a2\u3059\u308b\u30ac\u30a4\u30c9"},c="MCP \u30ed\u30ae\u30f3\u30b0\u4f7f\u7528\u65b9\u6cd5",t={},a=[{value:"\u57fa\u672c\u7684\u306a\u4f7f\u3044\u65b9",id:"\u57fa\u672c\u7684\u306a\u4f7f\u3044\u65b9",level:2},{value:"1. DI \u30b3\u30f3\u30c6\u30ca\u3078\u306e\u767b\u9332",id:"1-di-\u30b3\u30f3\u30c6\u30ca\u3078\u306e\u767b\u9332",level:3},{value:"2. \u30b3\u30f3\u30b9\u30c8\u30e9\u30af\u30bf\u30a4\u30f3\u30b8\u30a7\u30af\u30b7\u30e7\u30f3",id:"2-\u30b3\u30f3\u30b9\u30c8\u30e9\u30af\u30bf\u30a4\u30f3\u30b8\u30a7\u30af\u30b7\u30e7\u30f3",level:3},{value:"\u30ed\u30b0\u30ec\u30d9\u30eb",id:"\u30ed\u30b0\u30ec\u30d9\u30eb",level:2},{value:"\u30ed\u30b0\u51fa\u529b\u30d5\u30a9\u30fc\u30de\u30c3\u30c8",id:"\u30ed\u30b0\u51fa\u529b\u30d5\u30a9\u30fc\u30de\u30c3\u30c8",level:2},{value:"MCP \u5b9f\u884c\u30b3\u30f3\u30c6\u30ad\u30b9\u30c8\u306e\u4f7f\u3044\u65b9",id:"mcp-\u5b9f\u884c\u30b3\u30f3\u30c6\u30ad\u30b9\u30c8\u306e\u4f7f\u3044\u65b9",level:2},{value:"\u30c4\u30fc\u30eb\u30b9\u30b3\u30fc\u30d7\u306e\u4f5c\u6210",id:"\u30c4\u30fc\u30eb\u30b9\u30b3\u30fc\u30d7\u306e\u4f5c\u6210",level:3},{value:"\u76f8\u95a2ID\u3068\u30c4\u30fc\u30eb\u540d\u306e\u53d6\u5f97",id:"\u76f8\u95a2id\u3068\u30c4\u30fc\u30eb\u540d\u306e\u53d6\u5f97",level:3},{value:"MCP \u30ed\u30ae\u30f3\u30b0\u30dd\u30ea\u30b7\u30fc",id:"mcp-\u30ed\u30ae\u30f3\u30b0\u30dd\u30ea\u30b7\u30fc",level:2},{value:"\u30ed\u30b0\u306e\u8aad\u307f\u53d6\u308a",id:"\u30ed\u30b0\u306e\u8aad\u307f\u53d6\u308a",level:2},{value:"\u76f8\u95a2ID\u3067\u30ed\u30b0\u3092\u8aad\u307f\u53d6\u308b",id:"\u76f8\u95a2id\u3067\u30ed\u30b0\u3092\u8aad\u307f\u53d6\u308b",level:3},{value:"DI \u3078\u306e\u767b\u9332",id:"di-\u3078\u306e\u767b\u9332",level:3},{value:"\u8907\u6570\u30ed\u30ac\u30fc\u306e\u7d44\u307f\u5408\u308f\u305b",id:"\u8907\u6570\u30ed\u30ac\u30fc\u306e\u7d44\u307f\u5408\u308f\u305b",level:2},{value:"\u30c6\u30b9\u30c8\u3067\u306e\u4f7f\u7528\u4f8b",id:"\u30c6\u30b9\u30c8\u3067\u306e\u4f7f\u7528\u4f8b",level:2},{value:"Production \u74b0\u5883\u3067\u306e\u8a2d\u5b9a\u4f8b",id:"production-\u74b0\u5883\u3067\u306e\u8a2d\u5b9a\u4f8b",level:2},{value:"\u30d9\u30b9\u30c8\u30d7\u30e9\u30af\u30c6\u30a3\u30b9",id:"\u30d9\u30b9\u30c8\u30d7\u30e9\u30af\u30c6\u30a3\u30b9",level:2},{value:"\u30c8\u30e9\u30d6\u30eb\u30b7\u30e5\u30fc\u30c6\u30a3\u30f3\u30b0",id:"\u30c8\u30e9\u30d6\u30eb\u30b7\u30e5\u30fc\u30c6\u30a3\u30f3\u30b0",level:2},{value:"\u30c4\u30fc\u30eb\u540d\u304c\u8a18\u9332\u3055\u308c\u306a\u3044\u5834\u5408",id:"\u30c4\u30fc\u30eb\u540d\u304c\u8a18\u9332\u3055\u308c\u306a\u3044\u5834\u5408",level:3},{value:"\u30ed\u30b0\u30d5\u30a1\u30a4\u30eb\u304c\u898b\u3064\u304b\u3089\u306a\u3044\u5834\u5408",id:"\u30ed\u30b0\u30d5\u30a1\u30a4\u30eb\u304c\u898b\u3064\u304b\u3089\u306a\u3044\u5834\u5408",level:3},{value:"\u30ed\u30b0\u304c\u8aad\u307f\u53d6\u308c\u306a\u3044\u5834\u5408",id:"\u30ed\u30b0\u304c\u8aad\u307f\u53d6\u308c\u306a\u3044\u5834\u5408",level:3},{value:"\u53c2\u8003\u30ea\u30f3\u30af",id:"\u53c2\u8003\u30ea\u30f3\u30af",level:2}];function d(e){const n={a:"a",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,s.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(n.header,{children:(0,r.jsx)(n.h1,{id:"mcp-\u30ed\u30ae\u30f3\u30b0\u4f7f\u7528\u65b9\u6cd5",children:"MCP \u30ed\u30ae\u30f3\u30b0\u4f7f\u7528\u65b9\u6cd5"})}),"\n",(0,r.jsx)(n.h2,{id:"\u57fa\u672c\u7684\u306a\u4f7f\u3044\u65b9",children:"\u57fa\u672c\u7684\u306a\u4f7f\u3044\u65b9"}),"\n",(0,r.jsx)(n.h3,{id:"1-di-\u30b3\u30f3\u30c6\u30ca\u3078\u306e\u767b\u9332",children:"1. DI \u30b3\u30f3\u30c6\u30ca\u3078\u306e\u767b\u9332"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-csharp",children:"using Ateliers.Ai.Mcp.DependencyInjection;\nusing Ateliers.Ai.Mcp.Logging.DependencyInjection;\nusing Microsoft.Extensions.DependencyInjection;\n\nvar services = new ServiceCollection();\n\n// MCP \u5b9f\u884c\u30b3\u30f3\u30c6\u30ad\u30b9\u30c8\u3092\u767b\u9332\nservices.AddMcpExecutionContext();\n\n// MCP \u30ed\u30ae\u30f3\u30b0\u3092\u767b\u9332\nservices.AddMcpLogging(logging =>\n{\n    logging\n        .SetMinimumLevel(LogLevel.Information)    // \u6700\u5c0f\u30ed\u30b0\u30ec\u30d9\u30eb\n        .AddConsole()                             // \u30b3\u30f3\u30bd\u30fc\u30eb\u51fa\u529b\n        .AddFile();                               // \u30d5\u30a1\u30a4\u30eb\u51fa\u529b\uff08\u30c7\u30d5\u30a9\u30eb\u30c8: ./logs/app/mcp-*.log\uff09\n});\n\nvar serviceProvider = services.BuildServiceProvider();\n"})}),"\n",(0,r.jsx)(n.h3,{id:"2-\u30b3\u30f3\u30b9\u30c8\u30e9\u30af\u30bf\u30a4\u30f3\u30b8\u30a7\u30af\u30b7\u30e7\u30f3",children:"2. \u30b3\u30f3\u30b9\u30c8\u30e9\u30af\u30bf\u30a4\u30f3\u30b8\u30a7\u30af\u30b7\u30e7\u30f3"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-csharp",children:'using Ateliers.Ai.Mcp;\nusing Ateliers.Ai.Mcp.Logging;\n\npublic class NotionSyncTool\n{\n    private readonly IMcpExecutionContext _context;\n    private readonly IMcpLogger _logger;\n\n    public NotionSyncTool(IMcpExecutionContext context, IMcpLogger logger)\n    {\n        _context = context;\n        _logger = logger;\n    }\n\n    public async Task ExecuteAsync()\n    {\n        // \u30c4\u30fc\u30eb\u30b9\u30b3\u30fc\u30d7\u3092\u958b\u59cb\uff08\u76f8\u95a2ID\u3068\u30c4\u30fc\u30eb\u540d\u3092\u81ea\u52d5\u7ba1\u7406\uff09\n        using var scope = _context.BeginTool("notion.sync");\n        \n        _logger.Info("MCP.Start");\n        _logger.Debug($"Tool: {_context.ToolName}, CorrelationId: {_context.CorrelationId}");\n        \n        try\n        {\n            await SyncNotionAsync();\n            _logger.Info("MCP.Success");\n        }\n        catch (Exception ex)\n        {\n            _logger.Error("MCP.Failed", ex);\n            throw;\n        }\n    }\n\n    private async Task SyncNotionAsync()\n    {\n        _logger.Info("Syncing Notion data...");\n        // \u540c\u671f\u51e6\u7406\n        await Task.Delay(100);\n        _logger.Info("Sync completed");\n    }\n}\n'})}),"\n",(0,r.jsx)(n.h2,{id:"\u30ed\u30b0\u30ec\u30d9\u30eb",children:"\u30ed\u30b0\u30ec\u30d9\u30eb"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-csharp",children:'_logger.Trace("\u30c8\u30ec\u30fc\u30b9\u60c5\u5831");              // LogLevel.Trace\n_logger.Debug("\u30c7\u30d0\u30c3\u30b0\u60c5\u5831");              // LogLevel.Debug\n_logger.Info("\u60c5\u5831\u30e1\u30c3\u30bb\u30fc\u30b8");             // LogLevel.Information\n_logger.Warn("\u8b66\u544a\u30e1\u30c3\u30bb\u30fc\u30b8");             // LogLevel.Warning\n_logger.Error("\u30a8\u30e9\u30fc\u30e1\u30c3\u30bb\u30fc\u30b8", ex);      // LogLevel.Error\n_logger.Critical("\u91cd\u5927\u306a\u30a8\u30e9\u30fc", ex);       // LogLevel.Critical\n'})}),"\n",(0,r.jsx)(n.h2,{id:"\u30ed\u30b0\u51fa\u529b\u30d5\u30a9\u30fc\u30de\u30c3\u30c8",children:"\u30ed\u30b0\u51fa\u529b\u30d5\u30a9\u30fc\u30de\u30c3\u30c8"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:"[2025-01-23T10:00:00.0000000Z] [Information] [MCP] [CID:abc-123] [Tool:notion.sync] MCP.Start\n[2025-01-23T10:00:01.0000000Z] [Debug] [MCP] [CID:abc-123] [Tool:notion.sync] Tool: notion.sync, CorrelationId: abc-123\n[2025-01-23T10:00:02.0000000Z] [Information] [MCP] [CID:abc-123] [Tool:notion.sync] Syncing Notion data...\n[2025-01-23T10:00:03.0000000Z] [Information] [MCP] [CID:abc-123] [Tool:notion.sync] Sync completed\n[2025-01-23T10:00:04.0000000Z] [Information] [MCP] [CID:abc-123] [Tool:notion.sync] MCP.Success\n"})}),"\n",(0,r.jsx)(n.p,{children:"\u30d5\u30a9\u30fc\u30de\u30c3\u30c8\u8a73\u7d30\uff1a"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"[Timestamp]"}),": ISO 8601 \u5f62\u5f0f\u306e\u30bf\u30a4\u30e0\u30b9\u30bf\u30f3\u30d7\uff08UTC\uff09"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"[LogLevel]"}),": \u30ed\u30b0\u30ec\u30d9\u30eb"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"[MCP]"}),": \u30ab\u30c6\u30b4\u30ea\uff08\u81ea\u52d5\u8a2d\u5b9a\uff09"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"[CID:xxx]"}),": \u76f8\u95a2ID\uff08\u81ea\u52d5\u8a2d\u5b9a\uff09"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"[Tool:xxx]"}),": \u30c4\u30fc\u30eb\u540d\uff08BeginTool \u3067\u8a2d\u5b9a\uff09"]}),"\n",(0,r.jsx)(n.li,{children:"\u30e1\u30c3\u30bb\u30fc\u30b8\u672c\u6587"}),"\n"]}),"\n",(0,r.jsx)(n.h2,{id:"mcp-\u5b9f\u884c\u30b3\u30f3\u30c6\u30ad\u30b9\u30c8\u306e\u4f7f\u3044\u65b9",children:"MCP \u5b9f\u884c\u30b3\u30f3\u30c6\u30ad\u30b9\u30c8\u306e\u4f7f\u3044\u65b9"}),"\n",(0,r.jsx)(n.h3,{id:"\u30c4\u30fc\u30eb\u30b9\u30b3\u30fc\u30d7\u306e\u4f5c\u6210",children:"\u30c4\u30fc\u30eb\u30b9\u30b3\u30fc\u30d7\u306e\u4f5c\u6210"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-csharp",children:'public async Task ExecuteToolAsync(string toolName)\n{\n    // \u30c4\u30fc\u30eb\u30b9\u30b3\u30fc\u30d7\u3092\u958b\u59cb\uff08\u65b0\u3057\u3044\u76f8\u95a2ID\u3068\u30c4\u30fc\u30eb\u540d\u304c\u8a2d\u5b9a\u3055\u308c\u308b\uff09\n    using var scope = _context.BeginTool(toolName);\n    \n    _logger.Info($"MCP.Start tool={toolName}");\n    \n    // \u3053\u306e\u30b9\u30b3\u30fc\u30d7\u5185\u306e\u3059\u3079\u3066\u306e\u30ed\u30b0\u306b\u540c\u3058\u76f8\u95a2ID\u3068\u30c4\u30fc\u30eb\u540d\u304c\u4ed8\u4e0e\u3055\u308c\u308b\n    await ProcessToolAsync();\n    \n    _logger.Info($"MCP.Success tool={toolName}");\n}\n'})}),"\n",(0,r.jsx)(n.h3,{id:"\u76f8\u95a2id\u3068\u30c4\u30fc\u30eb\u540d\u306e\u53d6\u5f97",children:"\u76f8\u95a2ID\u3068\u30c4\u30fc\u30eb\u540d\u306e\u53d6\u5f97"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-csharp",children:'public void LogContextInfo()\n{\n    var correlationId = _context.CorrelationId;\n    var toolName = _context.ToolName;\n    \n    _logger.Info($"CorrelationId: {correlationId}, ToolName: {toolName}");\n}\n'})}),"\n",(0,r.jsx)(n.h2,{id:"mcp-\u30ed\u30ae\u30f3\u30b0\u30dd\u30ea\u30b7\u30fc",children:"MCP \u30ed\u30ae\u30f3\u30b0\u30dd\u30ea\u30b7\u30fc"}),"\n",(0,r.jsx)(n.p,{children:"MCP \u3067\u306f\u4ee5\u4e0b\u306e\u30ed\u30ae\u30f3\u30b0\u30dd\u30ea\u30b7\u30fc\u306b\u5f93\u3044\u307e\u3059\uff1a"}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"\u5fc5\u9808\u30ed\u30b0"}),":"]}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"MCP.Start"}),": \u30c4\u30fc\u30eb\u5b9f\u884c\u958b\u59cb\u6642"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"MCP.Success"}),": \u30c4\u30fc\u30eb\u5b9f\u884c\u6210\u529f\u6642"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"MCP.Failed"}),": \u30c4\u30fc\u30eb\u5b9f\u884c\u5931\u6557\u6642"]}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"\u63a8\u5968\u30ed\u30b0"}),":"]}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"\u91cd\u8981\u306a\u51e6\u7406\u306e\u30b9\u30c6\u30c3\u30d7"}),"\n",(0,r.jsx)(n.li,{children:"\u5916\u90e8\u30b5\u30fc\u30d3\u30b9\u3078\u306e\u30ea\u30af\u30a8\u30b9\u30c8/\u30ec\u30b9\u30dd\u30f3\u30b9"}),"\n",(0,r.jsx)(n.li,{children:"\u30c7\u30fc\u30bf\u306e\u5909\u63db/\u5909\u66f4"}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"\u7981\u6b62\u4e8b\u9805"}),":"]}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"\u500b\u4eba\u60c5\u5831\uff08PII\uff09\u306e\u30ed\u30b0\u51fa\u529b"}),"\n",(0,r.jsx)(n.li,{children:"\u8a8d\u8a3c\u30c8\u30fc\u30af\u30f3/\u30d1\u30b9\u30ef\u30fc\u30c9\u306e\u30ed\u30b0\u51fa\u529b"}),"\n",(0,r.jsx)(n.li,{children:"\u5927\u91cf\u30c7\u30fc\u30bf\u306e\u8a73\u7d30\u30ed\u30b0\uff08Debug \u30ec\u30d9\u30eb\u3067\u3082\u907f\u3051\u308b\uff09"}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,r.jsx)(n.h2,{id:"\u30ed\u30b0\u306e\u8aad\u307f\u53d6\u308a",children:"\u30ed\u30b0\u306e\u8aad\u307f\u53d6\u308a"}),"\n",(0,r.jsx)(n.h3,{id:"\u76f8\u95a2id\u3067\u30ed\u30b0\u3092\u8aad\u307f\u53d6\u308b",children:"\u76f8\u95a2ID\u3067\u30ed\u30b0\u3092\u8aad\u307f\u53d6\u308b"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-csharp",children:'using Ateliers.Ai.Mcp;\n\npublic class LogReaderService\n{\n    private readonly IMcpLogReader _logReader;\n\n    public LogReaderService(IMcpLogReader logReader)\n    {\n        _logReader = logReader;\n    }\n\n    public void ReadSessionLogs(string correlationId)\n    {\n        var session = _logReader.ReadByCorrelationId(correlationId);\n        \n        Console.WriteLine($"Session: {session.CorrelationId}");\n        foreach (var entry in session.Entries)\n        {\n            Console.WriteLine($"  [{entry.Timestamp}] [{entry.Level}] {entry.Message}");\n        }\n    }\n\n    public void ReadLastSession()\n    {\n        var session = _logReader.ReadLastSession();\n        \n        Console.WriteLine($"Last Session: {session.CorrelationId}");\n        foreach (var entry in session.Entries)\n        {\n            Console.WriteLine($"  [{entry.Timestamp}] [{entry.Level}] {entry.Message}");\n        }\n    }\n\n    public void ReadMcpLogs()\n    {\n        // \u30ab\u30c6\u30b4\u30ea\u3067\u30d5\u30a3\u30eb\u30bf\u30ea\u30f3\u30b0\n        var mcpSession = _logReader.ReadByCategory("MCP");\n        \n        Console.WriteLine($"MCP Logs: {mcpSession.Entries.Count} entries");\n        foreach (var entry in mcpSession.Entries)\n        {\n            Console.WriteLine($"  [{entry.Timestamp}] [{entry.ToolName}] {entry.Message}");\n        }\n    }\n\n    public void ReadToolLogs(string correlationId, string category = "MCP")\n    {\n        // \u76f8\u95a2ID\u3068\u30ab\u30c6\u30b4\u30ea\u306e\u4e21\u65b9\u3067\u30d5\u30a3\u30eb\u30bf\u30ea\u30f3\u30b0\n        var session = _logReader.ReadByCorrelationIdAndCategory(correlationId, category);\n        \n        Console.WriteLine($"Tool Logs: {session.CorrelationId} ({session.Entries.Count} entries)");\n        foreach (var entry in session.Entries)\n        {\n            Console.WriteLine($"  [{entry.Timestamp}] {entry.Message}");\n        }\n    }\n}\n'})}),"\n",(0,r.jsx)(n.h3,{id:"di-\u3078\u306e\u767b\u9332",children:"DI \u3078\u306e\u767b\u9332"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-csharp",children:'// \u30d5\u30a1\u30a4\u30eb\u30d9\u30fc\u30b9\u306e\u30ed\u30b0\u30ea\u30fc\u30c0\u30fc\nservices.AddSingleton<IMcpLogReader>(provider =>\n    new FileMcpLogger(new McpLoggerOptions\n    {\n        LogDirectory = "./logs/app"\n    }));\n\n// \u307e\u305f\u306f\u3001\u30a4\u30f3\u30e1\u30e2\u30ea\u30ed\u30b0\u30ea\u30fc\u30c0\u30fc\uff08\u30c6\u30b9\u30c8\u7528\uff09\nservices.AddSingleton<IMcpLogReader>(provider =>\n    new InMemoryMcpLogger(new McpLoggerOptions()));\n'})}),"\n",(0,r.jsx)(n.h2,{id:"\u8907\u6570\u30ed\u30ac\u30fc\u306e\u7d44\u307f\u5408\u308f\u305b",children:"\u8907\u6570\u30ed\u30ac\u30fc\u306e\u7d44\u307f\u5408\u308f\u305b"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-csharp",children:'services.AddMcpLogging(logging =>\n{\n    logging\n        .SetMinimumLevel(LogLevel.Debug)\n        .AddConsole()                                  // \u30b3\u30f3\u30bd\u30fc\u30eb\u306b\u51fa\u529b\n        .AddFile("./logs/mcp")                        // \u30d5\u30a1\u30a4\u30eb\u306b\u51fa\u529b\n        .AddInMemory(out var memoryLogger);           // \u30e1\u30e2\u30ea\u306b\u4fdd\u6301\uff08\u30c7\u30d0\u30c3\u30b0/\u30c6\u30b9\u30c8\u7528\uff09\n});\n'})}),"\n",(0,r.jsx)(n.h2,{id:"\u30c6\u30b9\u30c8\u3067\u306e\u4f7f\u7528\u4f8b",children:"\u30c6\u30b9\u30c8\u3067\u306e\u4f7f\u7528\u4f8b"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-csharp",children:'using Ateliers.Ai.Mcp;\nusing Ateliers.Ai.Mcp.Logging;\nusing Microsoft.Extensions.DependencyInjection;\nusing Xunit;\n\npublic class NotionSyncToolTests\n{\n    [Fact]\n    public async Task Test_ToolExecution()\n    {\n        // Arrange\n        var services = new ServiceCollection();\n        services.AddMcpExecutionContext();\n        \n        InMemoryMcpLogger memoryLogger = null!;\n        services.AddMcpLogging(logging =>\n        {\n            logging\n                .SetMinimumLevel(LogLevel.Debug)\n                .AddInMemory(out memoryLogger);\n        });\n        \n        var provider = services.BuildServiceProvider();\n        var tool = new NotionSyncTool(\n            provider.GetRequiredService<IMcpExecutionContext>(),\n            provider.GetRequiredService<IMcpLogger>());\n        \n        // Act\n        await tool.ExecuteAsync();\n        \n        // Assert\n        Assert.True(memoryLogger.Entries.Count >= 2); // \u6700\u4f4e\u9650 Start \u3068 Success\n        Assert.Contains(memoryLogger.Entries, e => e.Message == "MCP.Start");\n        Assert.Contains(memoryLogger.Entries, e => e.Message == "MCP.Success");\n        Assert.All(memoryLogger.Entries, e =>\n        {\n            Assert.Equal("MCP", e.Category);\n            Assert.Equal("notion.sync", e.ToolName);\n            Assert.NotNull(e.CorrelationId);\n        });\n    }\n\n    [Fact]\n    public void Test_LogReader()\n    {\n        // Arrange\n        var services = new ServiceCollection();\n        services.AddMcpExecutionContext();\n        \n        InMemoryMcpLogger memoryLogger = null!;\n        services.AddMcpLogging(logging =>\n        {\n            logging.AddInMemory(out memoryLogger);\n        });\n        \n        var provider = services.BuildServiceProvider();\n        var context = provider.GetRequiredService<IMcpExecutionContext>();\n        var logger = provider.GetRequiredService<IMcpLogger>();\n        \n        // Act\n        using (var scope = context.BeginTool("test.tool"))\n        {\n            logger.Info("Test message");\n        }\n        \n        var correlationId = context.CorrelationId;\n        var session = memoryLogger.ReadByCorrelationId(correlationId!);\n        \n        // Assert\n        Assert.Single(session.Entries);\n        Assert.Equal("Test message", session.Entries[0].Message);\n        Assert.Equal(correlationId, session.Entries[0].CorrelationId);\n        Assert.Equal("test.tool", session.Entries[0].ToolName);\n    }\n}\n'})}),"\n",(0,r.jsx)(n.h2,{id:"production-\u74b0\u5883\u3067\u306e\u8a2d\u5b9a\u4f8b",children:"Production \u74b0\u5883\u3067\u306e\u8a2d\u5b9a\u4f8b"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-csharp",children:'services.AddMcpLogging(logging =>\n{\n    logging\n        .SetMinimumLevel(LogLevel.Information)  // Production \u3067\u306f Information \u4ee5\u4e0a\n        .AddFile("./logs/mcp");                // \u30d5\u30a1\u30a4\u30eb\u306e\u307f\uff08\u30b3\u30f3\u30bd\u30fc\u30eb\u306f\u4e0d\u8981\uff09\n});\n\n// \u30ed\u30b0\u4fdd\u6301\u30dd\u30ea\u30b7\u30fc\u306e\u9069\u7528\uff08\u8d77\u52d5\u6642\u306b\u5b9f\u884c\uff09\nvar policy = new LogRetentionPolicy\n{\n    TraceRetention = TimeSpan.FromDays(1),\n    DebugRetention = TimeSpan.FromDays(3),\n    InformationRetention = TimeSpan.FromDays(14),\n    WarningRetention = TimeSpan.FromDays(30),\n    ErrorRetention = TimeSpan.FromDays(90),\n    CriticalRetention = TimeSpan.FromDays(90)\n};\n\nvar cleaner = new LogRetentionCleaner("./logs/mcp", policy);\ncleaner.Clean();\n'})}),"\n",(0,r.jsx)(n.h2,{id:"\u30d9\u30b9\u30c8\u30d7\u30e9\u30af\u30c6\u30a3\u30b9",children:"\u30d9\u30b9\u30c8\u30d7\u30e9\u30af\u30c6\u30a3\u30b9"}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"\u5fc5\u305a BeginTool \u3092\u4f7f\u7528\u3059\u308b"}),": \u30c4\u30fc\u30eb\u540d\u3068\u76f8\u95a2ID\u304c\u81ea\u52d5\u8a2d\u5b9a\u3055\u308c\u307e\u3059"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"MCP.Start / MCP.Success / MCP.Failed \u3092\u8a18\u9332\u3059\u308b"}),": \u30c4\u30fc\u30eb\u306e\u5b9f\u884c\u72b6\u6cc1\u3092\u8ffd\u8de1\u3067\u304d\u307e\u3059"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"\u9069\u5207\u306a\u30ed\u30b0\u30ec\u30d9\u30eb\u3092\u4f7f\u7528\u3059\u308b"}),":","\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Debug: \u958b\u767a\u6642\u306e\u307f"}),"\n",(0,r.jsx)(n.li,{children:"Information: \u901a\u5e38\u306e\u51e6\u7406\u30d5\u30ed\u30fc"}),"\n",(0,r.jsx)(n.li,{children:"Warning: \u4e88\u671f\u3057\u306a\u3044\u304c\u51e6\u7406\u53ef\u80fd\u306a\u72b6\u6cc1"}),"\n",(0,r.jsx)(n.li,{children:"Error: \u51e6\u7406\u5931\u6557"}),"\n",(0,r.jsx)(n.li,{children:"Critical: \u30b5\u30fc\u30d3\u30b9\u505c\u6b62\u30ec\u30d9\u30eb\u306e\u30a8\u30e9\u30fc"}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"\u4f8b\u5916\u306f\u5fc5\u305a\u30ed\u30b0\u306b\u8a18\u9332\u3059\u308b"}),": \u30b9\u30bf\u30c3\u30af\u30c8\u30ec\u30fc\u30b9\u304c\u4fdd\u5b58\u3055\u308c\u307e\u3059"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"\u500b\u4eba\u60c5\u5831\u3092\u8a18\u9332\u3057\u306a\u3044"}),": GDPR \u7b49\u306e\u30b3\u30f3\u30d7\u30e9\u30a4\u30a2\u30f3\u30b9\u3092\u9075\u5b88"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"\u76f8\u95a2ID\u3067\u30ed\u30b0\u3092\u8ffd\u8de1\u3059\u308b"}),": \u554f\u984c\u306e\u30c7\u30d0\u30c3\u30b0\u304c\u5bb9\u6613\u306b\u306a\u308a\u307e\u3059"]}),"\n"]}),"\n",(0,r.jsx)(n.h2,{id:"\u30c8\u30e9\u30d6\u30eb\u30b7\u30e5\u30fc\u30c6\u30a3\u30f3\u30b0",children:"\u30c8\u30e9\u30d6\u30eb\u30b7\u30e5\u30fc\u30c6\u30a3\u30f3\u30b0"}),"\n",(0,r.jsx)(n.h3,{id:"\u30c4\u30fc\u30eb\u540d\u304c\u8a18\u9332\u3055\u308c\u306a\u3044\u5834\u5408",children:"\u30c4\u30fc\u30eb\u540d\u304c\u8a18\u9332\u3055\u308c\u306a\u3044\u5834\u5408"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-csharp",children:'// BeginTool \u3092\u547c\u3073\u51fa\u3057\u3066\u3044\u308b\u304b\u78ba\u8a8d\nusing var scope = _context.BeginTool("tool.name");\n'})}),"\n",(0,r.jsx)(n.h3,{id:"\u30ed\u30b0\u30d5\u30a1\u30a4\u30eb\u304c\u898b\u3064\u304b\u3089\u306a\u3044\u5834\u5408",children:"\u30ed\u30b0\u30d5\u30a1\u30a4\u30eb\u304c\u898b\u3064\u304b\u3089\u306a\u3044\u5834\u5408"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-csharp",children:'// \u30c7\u30d5\u30a9\u30eb\u30c8\u306e\u30ed\u30b0\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u3092\u78ba\u8a8d\nvar logDir = Path.Combine(AppContext.BaseDirectory, "logs", "app");\nConsole.WriteLine($"Log directory: {logDir}");\n\n// \u307e\u305f\u306f\u3001\u660e\u793a\u7684\u306b\u30d1\u30b9\u3092\u6307\u5b9a\nservices.AddMcpLogging(logging =>\n{\n    logging.AddFile(logDirectory: "C:\\\\logs\\\\mcp");\n});\n'})}),"\n",(0,r.jsx)(n.h3,{id:"\u30ed\u30b0\u304c\u8aad\u307f\u53d6\u308c\u306a\u3044\u5834\u5408",children:"\u30ed\u30b0\u304c\u8aad\u307f\u53d6\u308c\u306a\u3044\u5834\u5408"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-csharp",children:'// IMcpLogReader \u304c\u767b\u9332\u3055\u308c\u3066\u3044\u308b\u304b\u78ba\u8a8d\nservices.AddSingleton<IMcpLogReader>(provider =>\n    provider.GetRequiredService<IMcpLogger>() as IMcpLogReader\n        ?? throw new InvalidOperationException("Logger does not implement IMcpLogReader"));\n'})}),"\n",(0,r.jsx)(n.h2,{id:"\u53c2\u8003\u30ea\u30f3\u30af",children:"\u53c2\u8003\u30ea\u30f3\u30af"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"../../docs/LoggingPolicy.md",children:"MCP Logging Policy"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"../../../Ateliers.Core/Logging/USAGE.md",children:"Ateliers.Core Logging USAGE"})}),"\n"]})]})}function g(e={}){const{wrapper:n}={...(0,s.R)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(d,{...e})}):d(e)}}}]);